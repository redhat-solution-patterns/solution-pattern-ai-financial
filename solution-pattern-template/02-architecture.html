<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Retreival Augmented Generation (RAG) AI workflow :: Solution Patterns for Cloud Native Architectures</title>
    <link rel="canonical" href="https://redhat-solution-patterns.github.io/solution-patterns/solution-pattern-template/02-architecture.html">
    <link rel="prev" href="index.html">
    <link rel="next" href="03-demo.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4L5WD0L52J"></script>
<script>function gtag() { dataLayer.push(arguments) }; window.dataLayer = window.dataLayer || []; gtag('js', new Date()); gtag('config', 'G-4L5WD0L52J')</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" style="font-size: 20px; color: white"
        href="https://redhat-solution-patterns.github.io/solution-patterns">
        <img src="../_/img/logo.png" height="35px" alt="Solution Patterns">&nbsp; Solution Patterns for Cloud Native Architectures</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Architectures &amp; Patterns</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://www.redhat.com/architect/portfolio/" target="_blank">Portfolio Architecture&nbsp; </a>
            <a class="navbar-item" href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html"  target="_blank">Solution Patterns </a>
            <a class="navbar-item" href="https://validatedpatterns.io/" target="_blank">Validated Patterns&nbsp;</a>
            <a class="navbar-item" href="https://catalog.redhat.com/solutions" target="_blank">Ecosystem Solutions&nbsp;</a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" target="_blank" href="https://developers.redhat.com">Red Hat Developers</a>
            <a class="navbar-item" target="_blank" href="https://developers.redhat.com/app-dev-platform">App Dev Platform</a>
            <a class="navbar-item" target="_blank" href="https://www.redhat.com/en/products/application-foundations">Red Hat Application Services</a>
          </div>
        </div>

          <a class="navbar-item" target="_blank" href="https://github.com/redhat-solution-patterns/redhat-solution-patterns.github.io/issues">Feedback</a>
          <a class="navbar-item" target="_blank" href="https://redhat-solution-patterns.github.io/solution-patterns/contributors-guide.html">Contribute</a>

      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="solution-pattern-template" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">RAG AI workflow</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">1. Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#use-cases">1.1 Use cases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_the_story_behind_this_solution_pattern">1.2 The story behind this solution pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_the_solution">1.3 The solution</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-architecture.html">2. Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#challenges">2.1. Common Challenges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#tech_stack">2.2. Technology stack</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#in_depth">2.3. An in-depth look at the solution&#8217;s architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#more_tech">2.4. More about the technology stack</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-demo.html">3. See the Solution in Action</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-demo.html#_demonstration">3.1. Demonstration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-demo.html#_run_the_demonstration">3.2. Run this demonstration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_before_getting_started">3.3. Pre-requisites</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_installing_the_demo">3.4. Installing the demo</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_walkthrough_guide">3.5. Walkthrough guide</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-workshop.html">4. Workshop</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-workshop.html#_installing_the_workshop_environment">4.1. Installing the workshop environment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-workshop.html#_before_getting_started">4.2. Pre-requisites</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-workshop.html#_installing_the_environment">4.3. Installing the environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-workshop.html#deliver_wksp">4.4. Delivering the workshop</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="developer-resources.html">5. Developer Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html" target="_blank" rel="noopener">Explore Red Hat Solution Patterns</a></span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RAG AI workflow</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">RAG AI workflow</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">RAG AI workflow</a></li>
    <li><a href="02-architecture.html">2. Architecture</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-solution-patterns/solution-pattern-ai-financial/edit/main/documentation/modules/ROOT/pages/02-architecture.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Retreival Augmented Generation (RAG) AI workflow</h1>
<h1 id="_architecture" class="sect0"><a class="anchor" href="#_architecture"></a><a class="link" href="#_architecture">Architecture</a></h1>
<div class="openblock partintro">
<div class="content">
Introduction for the architecture of this solution pattern.
</div>
</div>
<div class="sect1">
<h2 id="challenges"><a class="anchor" href="#challenges"></a><a class="link" href="#challenges">1. Common Challenges</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This solution pattern address the following challenges:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Integrating private knowledge into a generative AI workflow.</p>
</li>
<li>
<p>Capturing and syncronizing near real-time stock exchange data makes periodic fine tuning
of LLMs prohibitive.</p>
</li>
<li>
<p>Exposing private data sources via externally hosted API services Hosting AI services raises security
and privacy concerns for most enterprises.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tech_stack"><a class="anchor" href="#tech_stack"></a><a class="link" href="#tech_stack">2. Technology Stack</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Red Hat supported products:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.redhat.com/en/technologies/cloud-computing/openshift">Red Hat OpenShift</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="https://https://developers.redhat.com/products/openshift-dev-spaces/overview">Red Hat Openshift Dev Spaces</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://access.redhat.com/products/red-hat-application-foundations">Red Hat Application Foundation</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel/4.0">Red Hat build of Apache Camel</a> (included
with Red Hat Application Foundation)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Other open source products:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://weaviate.io/">Weaviate vector database</a></p>
</li>
<li>
<p><a href="https://ollama.com/">Ollama Model Server and model files</a></p>
</li>
<li>
<p><a href="https://https://huggingface.co/gradio">Gradio</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="in_depth"><a class="anchor" href="#in_depth"></a><a class="link" href="#in_depth">3. An in-depth look at the solution&#8217;s architecture</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>A closer look at the services and components that make up this solution pattern.</p>
</div>
<div class="sect2">
<h3 id="_data_flow"><a class="anchor" href="#_data_flow"></a><a class="link" href="#_data_flow">3.1. Data Flow</a></h3>
<div class="imageblock">
<div class="content">
<img src="_images/dataflow.jpg" alt="dataflow" width="100%">
</div>
</div>
<div class="sect3">
<h4 id="_ingest_engine"><a class="anchor" href="#_ingest_engine"></a><a class="link" href="#_ingest_engine">3.1.1. Ingest Engine</a></h4>
<div class="paragraph">
<p>Data flow begins at the source with stock information made available
via a RESTful API service hosted by Alpha Vantage. The ingest engine consisting
of two Camel services takes care of keeping data fresh in the Weaviate
vector database. The ingest processes are highly configurable and perform
filtering and discarding of invalid or null data. As stock symbol information is
read in, vector embeddings are generated and stored in the Weaviate vector database along
with the financial entities for each stock symbol. An example json record is available
in the <a href="https://www.alphavantage.co/query?function=OVERVIEW&amp;symbol=IBM&amp;apikey=demo">AlphaVantage API documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vector_database"><a class="anchor" href="#_vector_database"></a><a class="link" href="#_vector_database">3.1.2. Vector Database</a></h4>
<div class="paragraph">
<p>The vector database used is Weaviate. Weaviate is a highly performant and scalable open-source vector database
that simplifies the development of AI applications. Built-in vector and hybrid search, easy-to-connect machine
learning models, and a focus on data privacy enable developers of all levels to build, iterate, and scale AI
capabilities faster.</p>
</div>
</div>
<div class="sect3">
<h4 id="_machine_learning_ml_models"><a class="anchor" href="#_machine_learning_ml_models"></a><a class="link" href="#_machine_learning_ml_models">3.1.3. Machine Learning (ML) models</a></h4>
<div class="paragraph">
<p>This solution pattern makes use of two ML models, an enbeddings model (<code>all-minilm</code>) and an LLM (<code>granite3-dense:8b</code>)
which is configurable at run time. The enbeddings model is used to generate vector embeddings for each stock symbol and
the LLM summarizes the stock information. Granite a series of LLMs developed by IBM, specifically designed
for enterprise applications, focusing on business use cases like code generation, summarization, and classification,
with a strong emphasis on security and data privacy, all while being open-source under the Apache 2.0 license.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/rag-architecture.jpg" alt="rag architecture" width="100%">
</div>
</div>
<div class="paragraph">
<p></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_architecture_2"><a class="anchor" href="#_architecture_2"></a><a class="link" href="#_architecture_2">3.2. Architecture</a></h3>
<div class="sect3">
<h4 id="_ingest_engine_2"><a class="anchor" href="#_ingest_engine_2"></a><a class="link" href="#_ingest_engine_2">3.2.1. Ingest Engine</a></h4>
<div class="paragraph">
<p>The ingest engine consists of a caching proxy and syncronizer services. The caching proxy is a Camel service that
caches the stock information from the Alpha Vantage API and the syncronizer service is a Camel service that
synchronizes the data with the Weaviate vector database. The ingest engine is deployed on Openshift using a standard
source-to-image workflow. Details can be found in the <a href="https://github.com/joshdreagan/av-caching-proxy.git">caching proxy</a>
and <a href="https://github.com/joshdreagan/av-overview-sync.git">syncronizer</a> repositories.</p>
</div>
</div>
<div class="sect3">
<h4 id="_weaviate_vector_database"><a class="anchor" href="#_weaviate_vector_database"></a><a class="link" href="#_weaviate_vector_database">3.2.2. Weaviate vector database</a></h4>
<div class="paragraph">
<p>The Weaviate vector database is installed using the helm installer which allows for enterprise features to be enabled including
API key token authentication and data sharding. Weaviate&#8217;s cloud-native design supports horizontal scaling and efficient resource consumption,
allowing it to handle large volumes of data and user requests easily. Interested readers are encouraged to find out more
about <a href="https://www.redhat.com/en/blog/building-powerful-applications-weaviate-and-red-hat-openshift-retrieval-augmented-generation-workflow">the benefits of hosting Weaviate on Openshift</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ollama_model_server"><a class="anchor" href="#_ollama_model_server"></a><a class="link" href="#_ollama_model_server">3.2.3. Ollama Model Server</a></h4>
<div class="paragraph">
<p><a href="https://github.com/ollama/ollama">Ollama</a> is a popular and easy to use platform to host and serve LLMs. It supports a number of
operating systems and provides good integration and compatibility with the open source ecosystem including Weaviate. Ollama
is deployed on Openshift using a <a href="https://github.com/openshift/source-to-image">standard source-to-image workflow</a>. Details
can be found in this repository.</p>
</div>
</div>
<div class="sect3">
<h4 id="_user_interface"><a class="anchor" href="#_user_interface"></a><a class="link" href="#_user_interface">3.2.4. User Interface</a></h4>
<div class="paragraph">
<p>The UI is written in Python using the Gradio framework and is deployed using Openshift source-to-image workflow.
Example queries are presented to the user as pushbuttons to perform semantic
and generative queries. Users may also enter custom queries and prompts.</p>
</div>
</div>
<div class="sect3">
<h4 id="_developer_ide"><a class="anchor" href="#_developer_ide"></a><a class="link" href="#_developer_ide">3.2.5. Developer IDE</a></h4>
<div class="paragraph">
<p>Provided by Red Hat Openshift DevSpaces, this IDE allows developers to work with the codebase and test their changes
in a live environment.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="more_tech"><a class="anchor" href="#more_tech"></a><a class="link" href="#more_tech">4. About the Technology Stack</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://weaviate.io/">Weaviate</a> is an open-source vector database that makes it easy to build AI applications.
<a href="https://ollama.com/">Ollama</a> is a popular and easy to use platform to host and serve LLMs.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html" class="query-params-link">1. Introduction</a></span>
  <span class="next"><a href="03-demo.html" class="query-params-link">3. See the Solution in Action</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <img
          src="../_/img/app-services-logo.png" height="40px" alt="Cloud Native Architecture Solution Patterns"  href="https://redhat.com" ></a>
</footer><script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
