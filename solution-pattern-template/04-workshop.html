<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Solution Pattern: Name Template :: Solution Patterns for Cloud Native Architectures</title>
    <link rel="canonical" href="https://redhat-solution-patterns.github.io/solution-patterns/solution-pattern-template/04-workshop.html">
    <link rel="prev" href="03-demo.html">
    <link rel="next" href="developer-resources.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" style="font-size: 20px; color: white"
        href="https://redhat-solution-patterns.github.io/solution-patterns">
        <img src="../_/img/logo.png" height="35px" alt="Solution Patterns">&nbsp; Solution Patterns for Cloud Native Architectures</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Architectures &amp; Patterns</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://www.redhat.com/architect/portfolio/" target="_blank">Portfolio Architecture&nbsp; </a>
            <a class="navbar-item" href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html"  target="_blank">Solution Patterns </a>
            <a class="navbar-item" href="https://validatedpatterns.io/" target="_blank">Validated Patterns&nbsp;</a>
            <a class="navbar-item" href="https://catalog.redhat.com/solutions" target="_blank">Ecosystem Solutions&nbsp;</a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" target="_blank" href="https://developers.redhat.com">Red Hat Developers</a>
            <a class="navbar-item" target="_blank" href="https://developers.redhat.com/app-dev-platform">App Dev Platform</a>
            <a class="navbar-item" target="_blank" href="https://www.redhat.com/en/products/application-foundations">Red Hat Application Services</a>
          </div>
        </div>

          <a class="navbar-item" target="_blank" href="https://github.com/redhat-solution-patterns/redhat-solution-patterns.github.io/issues">Feedback</a>
          <a class="navbar-item" target="_blank" href="https://redhat-solution-patterns.github.io/solution-patterns/contributors-guide.html">Contribute</a>

      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="solution-pattern-template" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Template Tutorial</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">1. Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#use-cases">1.1 Use cases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_the_story_behind_this_solution_pattern">1.2 The story behind this solution pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_the_solution">1.3 The solution</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-architecture.html">2. Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#challenges">2.1. Common Challenges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#tech_stack">2.2. Technology stack</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#in_depth">2.3. An in-depth look at the solution&#8217;s architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#more_tech">2.4. More about the technology stack</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-demo.html">3. See the Solution in Action</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-demo.html#_demonstration">3.1. Demonstration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-demo.html#_run_the_demonstration">3.2. Run this demonstration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_before_getting_started">3.3. Pre-requisites</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_installing_the_demo">3.4. Installing the demo</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_walkthrough_guide">3.5. Walkthrough guide</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-workshop.html">4. Workshop</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#_installing_the_workshop_environment">4.1. Installing the workshop environment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#_before_getting_started">4.2. Pre-requisites</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#_installing_the_environment">4.3. Installing the environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#deliver_wksp">4.4. Delivering the workshop</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="developer-resources.html">5. Developer Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html" target="_blank" rel="noopener">Explore Red Hat Solution Patterns</a></span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Template Tutorial</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Template Tutorial</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Template Tutorial</a></li>
    <li><a href="04-workshop.html">4. Workshop</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-solution-patterns/solution-pattern-ai-financial/edit/main/documentation/modules/ROOT/pages/04-workshop.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Solution Pattern: Name Template</h1>
<h1 id="_workshop" class="sect0"><a class="anchor" href="#_workshop"></a><a class="link" href="#_workshop">Workshop</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>During this workshop youwill learn how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Get experience with a Weaviate enterprise installation.</p>
</li>
<li>
<p>Learn how to use the Weaviate Python client.</p>
</li>
<li>
<p>Learn how python application are deployed on Openshift</p>
</li>
<li>
<p>Work with the Gradio library to build a user interface.</p>
</li>
<li>
<p>Work with an LLM server on Openshift</p>
</li>
<li>
<p>Understand the various components that make up a RAG solution</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_the_workshop_environment"><a class="anchor" href="#_installing_the_workshop_environment"></a><a class="link" href="#_installing_the_workshop_environment">1. Installing the workshop environment</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_before_getting_started"><a class="anchor" href="#_before_getting_started"></a><a class="link" href="#_before_getting_started">1.1. Before getting started</a></h3>
<div class="sect3">
<h4 id="_prequisites"><a class="anchor" href="#_prequisites"></a><a class="link" href="#_prequisites">1.1.1. Prequisites</a></h4>
<div class="ulist">
<ul>
<li>
<p>An OpenShift Cluster</p>
<div class="ulist">
<ul>
<li>
<p>Version 4.16 or greater</p>
</li>
<li>
<p>A worker node with a minimum of 4 CPUs, 16 GB of memory and
a single NVIDIA T4 GPU with 16GB of memory. (AWS <code>g4dn.xlarge</code> or equivalent)</p>
</li>
<li>
<p>The <a href="https://docs.openshift.com/container-platform/4.17/web_console/web_terminal/installing-web-terminal.html">web-terminal</a>
operator</p>
</li>
</ul>
</div>
</li>
<li>
<p>A client system with the following software installed:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://mirror.openshift.com/pub/openshift-v4/clients/helm/latest">Helm</a></p>
</li>
<li>
<p><a href="https://maven.apache.org/download.cgi">Maven</a></p>
</li>
<li>
<p><a href="https://mirror.openshift.com/pub/openshift-v4/clients/ocp/latest/">The Openshift <code>oc</code> cli</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>An <a href="https://www.alphavantage.co/support/#api-key">AlphaVantage API Key</a> if you want to periodically
refresh the stock symbol data.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installing_the_environment"><a class="anchor" href="#_installing_the_environment"></a><a class="link" href="#_installing_the_environment">1.2. Installing the environment</a></h3>
<div class="paragraph">
<p>The following services on OpenShift are required:</p>
</div>
<div class="sect3">
<h4 id="_weaviate_vector_database"><a class="anchor" href="#_weaviate_vector_database"></a><a class="link" href="#_weaviate_vector_database">1.2.1. Weaviate Vector Database</a></h4>
<div class="ulist">
<ul>
<li>
<p><code>git clone <a href="https://github.com/redhat-na-ssa/demo-ai-weaviate" class="bare">https://github.com/redhat-na-ssa/demo-ai-weaviate</a></code></p>
</li>
<li>
<p><code>cd demo-ai-weaviate</code></p>
</li>
<li>
<p><code>oc apply -k deploy</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_ollama_llm_server"><a class="anchor" href="#_ollama_llm_server"></a><a class="link" href="#_ollama_llm_server">1.2.2. Ollama LLM Server</a></h4>
<div class="ulist">
<ul>
<li>
<p><code>oc apply -k ollama/deploy</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pull the necessary ML models:</p>
</div>
<div class="paragraph">
<p>Login to the Openshift console, open a terminal window in the <code>ollama</code> project
and run the following commands.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>curl <a href="http://ollama.ollama/api/pull" class="bare">http://ollama.ollama/api/pull</a> -d '{"model" : "all-minilm"}'</code></p>
</li>
<li>
<p><code>curl <a href="http://ollama.ollama/api/pull" class="bare">http://ollama.ollama/api/pull</a> -d '{"model" : "granite3-dense:8b"}'</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_stock_overview_ingestion_engine"><a class="anchor" href="#_stock_overview_ingestion_engine"></a><a class="link" href="#_stock_overview_ingestion_engine">1.2.3. Stock Overview Ingestion Engine</a></h4>
<div class="sect4">
<h5 id="_caching_proxy"><a class="anchor" href="#_caching_proxy"></a><a class="link" href="#_caching_proxy">Caching Proxy</a></h5>
<div class="paragraph">
<p>Follow the instructions to install the caching proxy in the <code>camel</code> namespace.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>oc new-project camel</code></p>
</li>
<li>
<p><code>git clone <a href="https://github.com/joshdreagan/av-caching-proxy.git" class="bare">https://github.com/joshdreagan/av-caching-proxy.git</a></code></p>
</li>
<li>
<p><code>cd av-caching-proxy</code></p>
</li>
<li>
<p><code>cp src/main/jkube/deployment.yml.template src/main/jkube/deployment.yml</code></p>
</li>
<li>
<p><code>cp src/main/jkube/configmap.yml.template src/main/jkube/configmap.yml</code></p>
</li>
<li>
<p><code>mvn -P openshift clean package oc:deploy</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default values for <code>deployment.yml</code>, and <code>configmap.yml</code> should be fine.</p>
</div>
</div>
<div class="sect4">
<h5 id="_stock_overview_syncronizer"><a class="anchor" href="#_stock_overview_syncronizer"></a><a class="link" href="#_stock_overview_syncronizer">Stock Overview Syncronizer</a></h5>
<div class="paragraph">
<p>Install the AlphaVantage syncronizer in the <code>camel</code> namespace.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>git clone <a href="https://github.com/joshdreagan/av-overview-sync.git" class="bare">https://github.com/joshdreagan/av-overview-sync.git</a></code></p>
</li>
<li>
<p><code>cd av-overview-sync</code></p>
</li>
<li>
<p><code>cp src/main/jkube/deployment.yml.template src/main/jkube/deployment.yml</code></p>
</li>
<li>
<p><code>cp src/main/jkube/configmap.yml.template src/main/jkube/configmap.yml</code></p>
</li>
<li>
<p><code>cp src/main/jkube/secret.yml.template src/main/jkube/secret.yml</code></p>
</li>
<li>
<p><code>mvn -P openshift clean package oc:deploy</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Configure the <code>src/main/jkube/configmap.yml</code> to use the <code>all-minilm</code> vectorizer model
and the <code>granite3-dense:8b</code> generative model.</p>
</div>
<div class="paragraph">
<p>Update your base64 encoded AlphaVantage API Key in the <code>src/main/jkube/secret.yml</code> file.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_gradio_ui_and_application"><a class="anchor" href="#_gradio_ui_and_application"></a><a class="link" href="#_gradio_ui_and_application">1.2.4. Gradio UI and application.</a></h4>
<div class="paragraph">
<p>From a terminal, create an OpenShift application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Obtain the
<a href="https://raw.githubusercontent.com/redhat-na-ssa/demo-ai-weaviate/refs/heads/main/deploy/weaviate/configmap.yaml">Weaviate API key</a>
and use it to create the RAG application.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><code>oc new-app python~https://github.com/redhat-na-ssa/demo-ai-weaviate --name rag --context-dir=/src --env WEAVIATE_API_KEY=your_weaviate_admin-api-key</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Expose the app with an external route and have fun.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>oc create route edge --service rag --insecure-policy=Redirect</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_workshop"><a class="anchor" href="#_running_the_workshop"></a><a class="link" href="#_running_the_workshop">1.3. Running the workshop</a></h3>
<div class="sect3">
<h4 id="_understanding_the_use_case"><a class="anchor" href="#_understanding_the_use_case"></a><a class="link" href="#_understanding_the_use_case">1.3.1. Understanding the Use case</a></h4>
<div class="paragraph">
<p>Let&#8217;s get started by having a look at the example
<a href="https://www.alphavantage.co/query?function=OVERVIEW&amp;symbol=IBM&amp;apikey=demo">IBM stock symbol json</a> to
explain the use case. Each json formatted data record includes the stock symbol, a company
name, a short description followed by a number of financial metrics. Imagine that you have been given
this data and are asked to write up a financial summary. This sounds like a typical task that a financial
analyist may be asked to perform and at first glance seems straight forward but the data is not
structured in a way that is easy to understand. Some of the data is represented as currency while
others are represented as ratios, percentages, dates and so on. The task becomes more challenging and time
consuming when more than one company must be analyzed not to mentioned that the data is semi-realtime
and could change several times day. This is where AI can help. In this workshop, we will make use of a vector
database and an LLM to give the analyst a head start on the task at hand.</p>
</div>
</div>
<div class="sect3">
<h4 id="_openshift_services"><a class="anchor" href="#_openshift_services"></a><a class="link" href="#_openshift_services">1.3.2. Openshift services.</a></h4>
<div class="sect4">
<h5 id="_weaviate"><a class="anchor" href="#_weaviate"></a><a class="link" href="#_weaviate">Weaviate</a></h5>
<div class="paragraph">
<p>At the center of the architecture is the Weaviate vector database. It it is deployed as an OpenShift
statefulset to provide resilency and performance. The Weaviate vector database is exposed as a RESTful API via
the internal service network to allow neighboring services such as the syncronizer and intelligent query clients
to interact with it.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ingest_engine"><a class="anchor" href="#_ingest_engine"></a><a class="link" href="#_ingest_engine">Ingest Engine</a></h5>
<div class="paragraph">
<p>The ingest engine consists of a caching proxy and syncronizer. Once these services are started, the Weaviate vector database is
initialized with a collection of 7118 stock symbol objects from a <a href="https://github.com/joshdreagan/av-overview-sync/blob/master/src/main/resources/data/company-overview.json">local file cache</a>.
As symbols are ingested, they are converted to vectors via the vectorizer model and upserted into Weaviate as embeddings.
Once this cold start sequence is complete, the syncronizer will periodically refresh a number of stock symbols. This
list of symbols of interest is may be configured at run time. Notice that the entire ingest engine
is highly configurable via <a href="https://github.com/joshdreagan/av-overview-sync/blob/master/src/main/jkube/configmap.yml.template#L7">Openshift configmaps</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ollama_model_server"><a class="anchor" href="#_ollama_model_server"></a><a class="link" href="#_ollama_model_server">Ollama Model Server</a></h5>
<div class="paragraph">
<p>The Ollama model server hosts a vectorizer and a large language model. To provide optimal performance and latency
it is accelerated by GPUs.</p>
</div>
</div>
<div class="sect4">
<h5 id="_developer_ide"><a class="anchor" href="#_developer_ide"></a><a class="link" href="#_developer_ide">Developer IDE</a></h5>
<div class="paragraph">
<p>Code assistance, debugging and enhanced developer experience is made possible by Openshift DevSpaces.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_running_the_rag_application"><a class="anchor" href="#_running_the_rag_application"></a><a class="link" href="#_running_the_rag_application">1.3.3. Running the RAG application.</a></h4>
<div class="paragraph">
<p>To run the itelligent application visit the <code>rag</code> route in a web browser. Start off near the top of the web page UI
by performing a semantic search using terms like "computers" or "commodities" and see the results. Also feel free
to try a term of your own.
The number of results can be changed using the horizontal slider. Weaviate will return the closest matches but only
the company names will appear in the UI.</p>
</div>
<div class="paragraph">
<p>Now choose a prompt template near the bottom half of the UI. This is where the magic happens. The Weaviate
SDK will fill-in the prompt template with the results of the semantic search and perform a generative search using the
power of the LLM. Again, experiment with your own prompts and have fun!</p>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="03-demo.html" class="query-params-link">3. See the Solution in Action</a></span>
  <span class="next"><a href="developer-resources.html" class="query-params-link">5. Developer Resources</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <img
          src="../_/img/app-services-logo.png" height="40px" alt="Cloud Native Architecture Solution Patterns"  href="https://redhat.com" ></a>
</footer><script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
